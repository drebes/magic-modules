resource "google_private_ca_certificate_authority" "<%= ctx[:primary_resource_id] %>" {
  provider = google-beta
  name     = "tf-test%{random_suffix}"
  location = "us-central1"
  lifetime = "30000s"
  type     = "SELF_SIGNED"
  tier     = "DEVOPS"

  key_spec {
    algorithm = "RSA_PSS_2048_SHA256"
  }
  config  {
    subject_config  {
      common_name = "Example Authority G1"
      subject {
        organization = "Example, Org."
      }
    }

    reusable_config {
      # TODO(drebes): Replace this by a data source. The returned project is by number
      # so either we make this computed or have the datasource convert it.
      reusable_config= "projects/568668481468/locations/us-central1/reusableConfigs/root-unconstrained"
    }
  }
}
